package ece596.ucsb.localizedwifi;

import android.graphics.Matrix;
import android.hardware.SensorManager;

public class CompassHelper {
	
	// values to compute orientation
    private static float[] mInclin;
    private static float[] mRot = new float[16];
    private static float[] rotValues = new float[3];
    Matrix matrix = new Matrix();
	
    
	public static Matrix getThetaMatrix(Float mGrav[], Float mGeom[]){
	    if (mGrav != null && mGeom != null) {
	    	boolean success = SensorManager.getRotationMatrix(mRot, mInclin, mGrav, mGeom);
			if (success){
				SensorManager.getOrientation(mRot, rotValues);
				rotValues[0] = (float) (((rotValues[0] + Math.PI/2) *180/Math.PI));
				if (rotValues[0] < 0)
					rotValues[0] = rotValues[0] + 360;
				
				matrix.reset();
				matrix.setRotate(rotValues[0]);
				
				return matrix;
			}
	    }
	    return null;
	}
	
}
